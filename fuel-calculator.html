<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fuel Cost Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #111827;
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }
    .container {
      background: #1f2937;
      border-radius: 16px;
      padding: 24px 24px 28px;
      max-width: 420px;
      width: 100%;
      box-shadow: 0 20px 40px rgba(0,0,0,0.4);
    }
    h1 {
      margin-top: 0;
      font-size: 1.4rem;
      margin-bottom: 0.75rem;
    }
    p.subtitle {
      margin-top: 0;
      color: #9ca3af;
      font-size: 0.9rem;
      margin-bottom: 1.5rem;
    }
    label {
      display: block;
      margin-bottom: 0.25rem;
      font-size: 0.9rem;
      color: #d1d5db;
    }
    input {
      width: 100%;
      padding: 0.55rem 0.75rem;
      border-radius: 8px;
      border: 1px solid #374151;
      background: #111827;
      color: #e5e7eb;
      font-size: 0.95rem;
      box-sizing: border-box;
    }
    input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 1px #3b82f6;
    }
    .row {
      margin-bottom: 1rem;
    }
    .inline {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    .inline span {
      font-size: 0.9rem;
      color: #9ca3af;
      white-space: nowrap;
    }
    button {
      border: none;
      border-radius: 999px;
      padding: 0.55rem 1rem;
      font-size: 0.9rem;
      cursor: pointer;
      font-weight: 500;
    }
    .btn-primary {
      background: #3b82f6;
      color: white;
    }
    .btn-primary:hover {
      background: #2563eb;
    }
    .btn-secondary {
      background: #374151;
      color: #e5e7eb;
    }
    .btn-secondary:hover {
      background: #4b5563;
    }
    .buttons {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.35rem;
      flex-wrap: wrap;
    }
    .result-card {
      margin-top: 1.25rem;
      padding: 0.9rem 0.85rem;
      border-radius: 12px;
      background: #111827;
      border: 1px solid #374151;
      font-size: 0.95rem;
    }
    .result-main {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 0.2rem;
    }
    .result-sub {
      font-size: 0.85rem;
      color: #9ca3af;
    }
    .saved-price {
      font-size: 0.8rem;
      color: #9ca3af;
      margin-top: 0.2rem;
    }
    .error {
      color: #f97373;
      font-size: 0.8rem;
      margin-top: 0.25rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Fuel Cost Calculator</h1>
    <p class="subtitle">Enter pump price in pence (like the display), then how many litres you filled.</p>

    <!-- Pump price -->
    <div class="row">
      <label for="pricePence">Pump price (pence per litre)</label>
      <div class="inline">
        <input type="number" id="pricePence" step="0.1" min="0" placeholder="e.g. 138.9">
        <span>p / litre</span>
      </div>
      <div class="buttons">
        <button class="btn-primary" id="savePriceBtn">Save price</button>
        <button class="btn-secondary" id="useSavedPriceBtn">Use saved price</button>
      </div>
      <div class="saved-price" id="savedPriceInfo"></div>
      <div class="error" id="priceError"></div>
    </div>

    <!-- Amount filled -->
    <div class="row">
      <label for="litres">Amount filled</label>
      <div class="inline">
        <input type="number" id="litres" step="0.01" min="0" placeholder="e.g. 42.5">
        <span>litres</span>
      </div>
      <div class="buttons">
        <button class="btn-primary" id="calcBtn">Calculate cost</button>
        <button class="btn-secondary" id="clearBtn">Clear</button>
      </div>
      <div class="error" id="litresError"></div>
    </div>

    <!-- Result -->
    <div class="result-card" id="resultCard" style="display:none;">
      <div class="result-main" id="totalCost"></div>
      <div class="result-sub" id="details"></div>
    </div>
  </div>

  <script>
    const PRICE_KEY = "fuel_calc_pump_price_pounds";

    const pricePenceInput = document.getElementById("pricePence");
    const litresInput = document.getElementById("litres");
    const savedPriceInfo = document.getElementById("savedPriceInfo");
    const priceError = document.getElementById("priceError");
    const litresError = document.getElementById("litresError");
    const resultCard = document.getElementById("resultCard");
    const totalCostEl = document.getElementById("totalCost");
    const detailsEl = document.getElementById("details");

    const savePriceBtn = document.getElementById("savePriceBtn");
    const useSavedPriceBtn = document.getElementById("useSavedPriceBtn");
    const calcBtn = document.getElementById("calcBtn");
    const clearBtn = document.getElementById("clearBtn");

    function loadSavedPrice() {
      const saved = localStorage.getItem(PRICE_KEY);
      if (saved !== null && !isNaN(parseFloat(saved))) {
        const pounds = parseFloat(saved);
        const pence = pounds * 100;
        savedPriceInfo.textContent =
          `Saved pump price: £${pounds.toFixed(3)} per litre (${pence.toFixed(1)} p/l)`;
        return pounds;
      } else {
        savedPriceInfo.textContent = "No pump price saved yet.";
        return null;
      }
    }

    function showError(el, msg) {
      el.textContent = msg || "";
    }

    // On load, show saved price
    loadSavedPrice();

    savePriceBtn.addEventListener("click", () => {
      showError(priceError, "");
      const penceValue = parseFloat(pricePenceInput.value);
      if (isNaN(penceValue) || penceValue <= 0) {
        showError(priceError, "Enter a valid pump price in pence (e.g. 138.9).");
        return;
      }
      const pounds = penceValue / 100;
      localStorage.setItem(PRICE_KEY, pounds.toString());
      const pence = pounds * 100;
      savedPriceInfo.textContent =
        `Saved pump price: £${pounds.toFixed(3)} per litre (${pence.toFixed(1)} p/l)`;
    });

    useSavedPriceBtn.addEventListener("click", () => {
      showError(priceError, "");
      const pounds = loadSavedPrice();
      if (pounds === null) {
        showError(priceError, "No saved price found. Please enter and save one first.");
      } else {
        const pence = pounds * 100;
        pricePenceInput.value = pence.toFixed(1);
      }
    });

    calcBtn.addEventListener("click", () => {
      showError(priceError, "");
      showError(litresError, "");
      resultCard.style.display = "none";

      const penceValue = parseFloat(pricePenceInput.value);
      const litres = parseFloat(litresInput.value);

      if (isNaN(penceValue) || penceValue <= 0) {
        showError(priceError, "Enter a valid pump price in pence (e.g. 138.9).");
        return;
      }
      if (isNaN(litres) || litres <= 0) {
        showError(litresError, "Enter how many litres you filled up.");
        return;
      }

      const pricePounds = penceValue / 100;
      const cost = pricePounds * litres;

      totalCostEl.textContent = `Total cost: £${cost.toFixed(2)}`;
      detailsEl.textContent =
        `${litres.toFixed(2)} litres × £${pricePounds.toFixed(3)} per litre (${penceValue.toFixed(1)} p/l)`;
      resultCard.style.display = "block";
    });

    clearBtn.addEventListener("click", () => {
      pricePenceInput.value = "";
      litresInput.value = "";
      showError(priceError, "");
      showError(litresError, "");
      resultCard.style.display = "none";
    });
  </script>
</body>
</html>
